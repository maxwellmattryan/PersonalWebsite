{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@ui/core/auth\";\nimport * as i2 from \"../../services\";\nimport * as i3 from \"@ui/core/services\";\nimport * as i4 from \"@ui/modules/portfolio/services\";\nimport * as i5 from \"@angular/platform-browser\";\nconst _c0 = (a0, a1, a2) => ({\n  \"btn-loading\": a0,\n  \"btn--active\": a1,\n  \"blog__filter-btn--half\": a2\n});\nfunction BlogViewComponent_div_0_ng_container_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 13);\n    i0.ɵɵelement(2, \"div\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction BlogViewComponent_div_0_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \" All \");\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction BlogViewComponent_div_0_ng_container_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"button\", 15);\n    i0.ɵɵtext(2, \" + \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction BlogViewComponent_div_0_div_13_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 13);\n    i0.ɵɵelement(2, \"div\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction BlogViewComponent_div_0_div_13_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const topic_r4 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", topic_r4.name, \" \");\n  }\n}\nfunction BlogViewComponent_div_0_div_13_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function BlogViewComponent_div_0_div_13_ng_container_4_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const topic_r4 = i0.ɵɵnextContext().$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.sendTopicToEditor(topic_r4));\n    });\n    i0.ɵɵtext(2, \" \\u270F \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function BlogViewComponent_div_0_div_13_ng_container_4_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const topic_r4 = i0.ɵɵnextContext().$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.deleteTopic(topic_r4));\n    });\n    i0.ɵɵtext(4, \" \\u2715 \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction BlogViewComponent_div_0_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function BlogViewComponent_div_0_div_13_Template_button_click_1_listener() {\n      const topic_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.filterPosts(topic_r4.id));\n    });\n    i0.ɵɵtemplate(2, BlogViewComponent_div_0_div_13_ng_container_2_Template, 3, 0, \"ng-container\", 10)(3, BlogViewComponent_div_0_div_13_ng_container_3_Template, 2, 1, \"ng-container\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, BlogViewComponent_div_0_div_13_ng_container_4_Template, 5, 0, \"ng-container\", 10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const topic_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(4, _c0, ctx_r1.isFilteringPosts && topic_r4.id === ctx_r1.activeTopicId, topic_r4.id === ctx_r1.activeTopicId, ctx_r1.isAdmin));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isFilteringPosts && topic_r4.id === ctx_r1.activeTopicId);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !(ctx_r1.isFilteringPosts && topic_r4.id === ctx_r1.activeTopicId));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isAdmin);\n  }\n}\nfunction BlogViewComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"h1\", 3);\n    i0.ɵɵtext(2, \"Welcome to my blog!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 4)(4, \"h2\", 5);\n    i0.ɵɵtext(5, \"Topics\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"div\", 6);\n    i0.ɵɵelementStart(7, \"div\", 7)(8, \"div\", 8)(9, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function BlogViewComponent_div_0_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.filterPosts(-1));\n    });\n    i0.ɵɵtemplate(10, BlogViewComponent_div_0_ng_container_10_Template, 3, 0, \"ng-container\", 10)(11, BlogViewComponent_div_0_ng_container_11_Template, 2, 0, \"ng-container\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, BlogViewComponent_div_0_ng_container_12_Template, 3, 0, \"ng-container\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, BlogViewComponent_div_0_div_13_Template, 5, 8, \"div\", 11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(14, \"ui-blog-post-collection\", 12);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(9);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(8, _c0, ctx_r1.isFilteringPosts && ctx_r1.activeTopicId === -1, ctx_r1.activeTopicId === -1, ctx_r1.isAdmin));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isFilteringPosts && ctx_r1.activeTopicId === -1);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !(ctx_r1.isFilteringPosts && ctx_r1.activeTopicId === -1));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isAdmin);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.topics)(\"ngForTrackBy\", ctx_r1.trackingService.objectById);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"posts\", ctx_r1.posts)(\"showPreview\", true);\n  }\n}\nfunction BlogViewComponent_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"ui-loading-spinner\");\n  }\n}\nexport let BlogViewComponent = /*#__PURE__*/(() => {\n  class BlogViewComponent {\n    constructor(authService, blogApiService, blogComparisonService, blogEditorService, blogTopicService, notificationService, portfolioProfileService, titleService, trackingService) {\n      this.authService = authService;\n      this.blogApiService = blogApiService;\n      this.blogComparisonService = blogComparisonService;\n      this.blogEditorService = blogEditorService;\n      this.blogTopicService = blogTopicService;\n      this.notificationService = notificationService;\n      this.portfolioProfileService = portfolioProfileService;\n      this.titleService = titleService;\n      this.trackingService = trackingService;\n      this.isAdmin = false;\n      this.isLoaded = false;\n      this.activeTopicId = -1;\n      this.isFilteringPosts = false;\n    }\n    ngOnInit() {\n      this.titleService.setTitle(`${this.portfolioProfileService.getActiveProfileName()} Blog | Matthew Maxwell`);\n      this.isAdmin = this.authService.isLoggedIn();\n      this.blogApiService.getPosts(this.activeTopicId, !this.isAdmin).subscribe(res => {\n        this.posts = res;\n        this.topics = this.getTopicsFromPosts().sort(this.blogComparisonService.topics);\n        if (this.blogTopicService.hasActiveTopic()) {\n          this.filterPosts(this.blogTopicService.getActiveTopicId());\n          this.blogTopicService.setActiveTopic(null);\n        }\n        this.isLoaded = true;\n      });\n    }\n    getTopicsFromPosts() {\n      let result = [];\n      this.posts.forEach(p => {\n        p.topics.forEach(t => {\n          if (!result.map(bt => bt.id).includes(t.id)) result.push(t);\n        });\n      });\n      return result;\n    }\n    filterPosts(topicId) {\n      this.activeTopicId = topicId;\n      this.isFilteringPosts = true;\n      if (this.isAdmin) {\n        this.blogApiService.getPosts(topicId, false).subscribe(res => {\n          this.posts = res;\n          this.isFilteringPosts = false;\n        }, error => {\n          this.notificationService.createNotification(error.error.message);\n          this.isFilteringPosts = false;\n          this.activeTopicId = -1;\n        });\n      } else {\n        this.blogApiService.getPosts(topicId).subscribe(res => {\n          this.posts = res;\n          this.isFilteringPosts = false;\n        }, error => {\n          this.notificationService.createNotification(error.error.message);\n          this.isFilteringPosts = false;\n          this.activeTopicId = -1;\n        });\n      }\n    }\n    sendTopicToEditor(topic) {\n      this.blogEditorService.setTopic(topic);\n    }\n    deleteTopic(topic) {\n      if (!this.notificationService.deleteConfirmation('blog topic')) return;\n      this.blogApiService.deleteTopic(topic.id).subscribe(res => {\n        this.removeTopic(topic.id);\n        this.notificationService.createNotification('Successfully deleted blog topic!');\n        this.filterPosts(-1);\n      }, error => {\n        this.notificationService.createNotification(error.error.message);\n      });\n    }\n    removeTopic(id) {\n      this.topics = this.topics.filter(t => t.id != id);\n      this.posts = this.posts.filter(p => !p.topics.map(t => t.id).includes(id));\n    }\n    static #_ = this.ɵfac = function BlogViewComponent_Factory(t) {\n      return new (t || BlogViewComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.BlogApiService), i0.ɵɵdirectiveInject(i2.BlogComparisonService), i0.ɵɵdirectiveInject(i2.BlogEditorService), i0.ɵɵdirectiveInject(i2.BlogTopicService), i0.ɵɵdirectiveInject(i3.NotificationService), i0.ɵɵdirectiveInject(i4.PortfolioProfileService), i0.ɵɵdirectiveInject(i5.Title), i0.ɵɵdirectiveInject(i3.TrackingService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: BlogViewComponent,\n      selectors: [[\"ui-blog-view\"]],\n      decls: 3,\n      vars: 2,\n      consts: [[\"loading\", \"\"], [\"class\", \"blog\", 4, \"ngIf\", \"ngIfElse\"], [1, \"blog\"], [1, \"blog__header\"], [1, \"section\", \"topics\"], [1, \"blog__filter-header\"], [1, \"line-divider\"], [1, \"blog__filter-btn-container\"], [1, \"blog__filter-btn-row\", \"blog__filter-btn-row--all\"], [\"aria-label\", \"Select all topics\", \"type\", \"button\", 1, \"btn\", \"blog__filter-btn\", \"blog__filter-btn--all\", 3, \"click\", \"ngClass\"], [4, \"ngIf\"], [\"class\", \"blog__filter-btn-row\", 4, \"ngFor\", \"ngForOf\", \"ngForTrackBy\"], [\"baseRoute\", \"posts/\", 3, \"posts\", \"showPreview\"], [1, \"btn-loader-container\"], [1, \"btn-loader\"], [\"aria-label\", \"Edit blog topic\", \"routerLink\", \"/blog/topics/editor\", 1, \"btn\", \"blog__filter-btn--add\", \"btn--go\"], [1, \"blog__filter-btn-row\"], [\"aria-label\", \"Filter blog topic\", \"type\", \"button\", 1, \"btn\", \"blog__filter-btn\", 3, \"click\", \"ngClass\"], [\"aria-label\", \"Edit blog topic\", \"routerLink\", \"/blog/topics/editor\", 1, \"btn\", \"blog__filter-btn--edit\", 3, \"click\"], [\"aria-label\", \"Delete blog topic\", \"type\", \"button\", 1, \"btn\", \"blog__filter-btn--edit\", \"btn--warn\", 3, \"click\"]],\n      template: function BlogViewComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵtemplate(0, BlogViewComponent_div_0_Template, 15, 12, \"div\", 1)(1, BlogViewComponent_ng_template_1_Template, 1, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n        }\n        if (rf & 2) {\n          const loading_r6 = i0.ɵɵreference(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoaded)(\"ngIfElse\", loading_r6);\n        }\n      },\n      styles: [\".blog[_ngcontent-%COMP%]{background-color:#333944;display:grid;grid-template-areas:\\\"header\\\" \\\"topics\\\" \\\"posts\\\";height:auto}.blog[_ngcontent-%COMP%]   .blog__header[_ngcontent-%COMP%]{grid-area:header}.blog[_ngcontent-%COMP%]   .topics[_ngcontent-%COMP%]{grid-area:topics;min-height:auto;margin:0}.blog[_ngcontent-%COMP%]   .posts[_ngcontent-%COMP%]{grid-area:posts}.blog__header[_ngcontent-%COMP%]{margin:0 auto 2rem;padding:2rem;text-align:center}.blog__filter-header[_ngcontent-%COMP%]{margin-bottom:1rem}.blog__filter-btn-container[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column}.blog__filter-btn[_ngcontent-%COMP%]{font-size:90%;height:48px;line-height:48px;width:100%}.blog__filter-btn--add[_ngcontent-%COMP%], .blog__filter-btn--edit[_ngcontent-%COMP%]{height:36px;line-height:36px;margin-left:1rem}.blog__filter-btn--add[_ngcontent-%COMP%]{font-size:170%;width:calc(112px + 1rem)}.blog__filter-btn--edit[_ngcontent-%COMP%]{font-size:118%;width:56px}.blog__filter-btn--half[_ngcontent-%COMP%]{min-width:184px}.blog__filter-btn-row[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;justify-content:space-between;width:100%}.blog__filter-btn-row--all[_ngcontent-%COMP%]{margin-bottom:2rem}@media only screen and (min-width: 768px){.blog__filter-btn[_ngcontent-%COMP%]{font-size:90%;height:56px;line-height:56px;width:232px}.blog__filter-btn--add[_ngcontent-%COMP%], .blog__filter-btn--edit[_ngcontent-%COMP%]{width:52px}.blog__filter-btn--add[_ngcontent-%COMP%]{width:calc(104px + 1rem)}.blog[_ngcontent-%COMP%]{grid-template-areas:\\\"header header header header header\\\" \\\"topics posts posts posts posts\\\"}.blog[_ngcontent-%COMP%]   .topics[_ngcontent-%COMP%]{margin:0 auto;min-height:92vh}  .section-divider{height:0}}\"]\n    });\n  }\n  return BlogViewComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}